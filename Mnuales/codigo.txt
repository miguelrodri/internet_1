'Imports Oracle.DataAccess.Client
'Imports Oracle.DataAccess.Types
Imports System.Data.OracleClient


Public Class Form1
    'definicion de un objeto para la conexion'
    Dim con As New OracleConnection

   
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        'valores para realizar la conexion a la bdprueba
        Dim ds As String = "127.0.0.1" 'data source
        Dim user As String = "prueba" 'usuario
        Dim pw As String = "123456" 'contraseña

        con.ConnectionString = "User Id=" + user & _
            ";Password=" + pw & _
            ";Data Source=" + ds

        Try
            con.Open() 'abrir la conexion
            'MessageBox.Show("HOLA")

            'Consulta a traves de una variable tipo string
            Dim sql As String = "select * from dept where deptno > 10"

            Dim cmd As New OracleCommand(sql, con) 'creacion de un obj command
            cmd.CommandType = CommandType.Text

            'informacion almacenada en dr (obj datareader)
            Dim dr As OracleDataReader = cmd.ExecuteReader()

            While (dr.Read())
                txtCod.Text = dr.GetInt32(0).ToString
                txtDep.Text = dr.GetString(1)
                txtLoc.Text = dr.GetString(2)
                MessageBox.Show("")
            End While

            'de.Read() solo nos trae un registro

            'asignar el valor a la caja de texto que se obtuvo de la consulta (dr) 
            'txtCod.Text = dr.GetInt32(0).ToString
            'txtDep.Text = dr.GetString(1)
            'txtLoc.Text = dr.GetString(2)

        Catch ex As Exception
            MessageBox.Show(ex.Message.ToString)
        End Try

    End Sub
End Class